{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CyberNetCall</title>
  
  <link rel="manifest" href="{% static 'cnc/manifest.json' %}">
  <link rel="icon" href="{% static 'cnc/icons/icon-192x192.png' %}">
  <link rel="stylesheet" href="{% static 'cnc/style.css' %}">
  
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-messaging-compat.js"></script>
  
  <script>
    // Django view ã‹ã‚‰æ¸¡ã•ã‚ŒãŸ Firebase è¨­å®šã‚’ JSON ã¨ã—ã¦åŸ‹ã‚è¾¼ã‚€
    // ã“ã®ã‚¿ã‚°ãŒã€app.js ã§ä½¿ç”¨ã•ã‚Œã‚‹ FCM_CONFIG ã®å†…å®¹ã‚’æä¾›ã—ã¾ã™
    const FCM_CONFIG_CLIENT = {{ FCM_CONFIG_CLIENT|safe }};
    // åŸ‹ã‚è¾¼ã¿å¾Œã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨ã—ã¦ app.js ã§åˆ©ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™
  </script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.10/purify.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" defer></script>
  <script src="https://unpkg.com/idb@7/build/umd.js" defer></script>
  <script src="https://unpkg.com/html5-qrcode" defer></script>
  
  <script src="{% static 'cnc/app.js' %}" defer></script>
</head>
<body>
  <h1>CyberNetCall</h1>
  <div id="connectionStatus"></div>
  
  <canvas id="qrcode"></canvas>
  <button id="startScanButton" style="margin-top: 1rem;">Scan QR Code</button>
  <div id="qr-reader" style="width: 300px; margin: 20px auto; display: none;"></div>
  <div id="qr-reader-results" style="margin-top: 10px; font-style: italic;"></div>

  <section class="section">
    <h2>Direct Mail</h2>
    <label for="messageInput" class="visually-hidden">Direct Message</label>
    <input type="text" id="messageInput" placeholder="Type a message..." aria-label="Direct Message">
    <button id="sendMessage">Send</button>
    <div id="messageArea" class="message-area"></div>
  </section>

  <section class="section">
    <h2>Group Chat</h2>
    <label for="postInput" class="visually-hidden">Post Friends</label>
    <input type="text" id="postInput" placeholder="Write your post..." aria-label="Post Content">
    <button id="sendPost">Post</button>
    <div id="postArea" class="post-area"></div>
  </section>

  <section class="section">
    <h2>Video Meeting</h2>
    
    <div class="video-container">
      <div class="video-scroll-container">
        <video id="localVideo" autoplay muted playsinline></video>
        </div>
      <div class="video-scroll-controls">
        <button id="scrollLeft">â†</button>
        <button id="scrollRight">â†’</button>
      </div>
    </div>
    <div class="call-controls">
      <button id="callButton" aria-label="Start/End Call">ğŸ“</button>
      <button id="videoButton" aria-label="Toggle Video">ğŸ¥</button>
    </div>
    <div style="margin-top: 1rem;">
        <label for="fileInput">Share File:</label>
        <input type="file" id="fileInput">
        <button id="sendFile">Send File</button>
        <span id="file-transfer-status" style="margin-left: 10px; font-style: italic;"></span>
    </div>
  </section>

  <script>
    // ... (æ—¢å­˜ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‡¦ç†ã®ãƒ­ã‚¸ãƒƒã‚¯) ...
    const scrollLeftButton = document.getElementById('scrollLeft');
    const scrollRightButton = document.getElementById('scrollRight');
    const videoScrollContainer = document.querySelector('.video-scroll-container');

    if (scrollLeftButton && scrollRightButton && videoScrollContainer) {
      scrollLeftButton.addEventListener('click', () => {
        videoScrollContainer.scrollBy({ left: -300, behavior: 'smooth' });
      });
      scrollRightButton.addEventListener('click', () => {
        videoScrollContainer.scrollBy({ left: 300, behavior: 'smooth' });
      });
    }
  </script>

</body>
</html>